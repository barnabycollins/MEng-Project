import"./modulepreload-polyfill.b7f2da20.js";import{a as x,f as p,i as v,S as b}from"./synthContext.622f2464.js";let n=[],o,u;const m=document.getElementById("start-btn");m.addEventListener("click",k);const E=document.getElementById("main-ui"),a=document.getElementById("score-slider"),d=document.getElementById("score-value");a.addEventListener("change",()=>d.innerText=a.value);const T=document.getElementById("score-submit");T.addEventListener("click",I);const c=document.getElementById("finish-btn");c==null||c.addEventListener("click",B);const h=document.getElementById("save-btn"),C=document.getElementsByTagName("h1")[0],s=document.getElementsByTagName("h2")[0];let t=0,r=1,y,l=!1,i={user:[],mfcc:[]};function B(){x(i,"userMfccTest"),h.style.display="block"}async function I(){if(l)return;l=!0;const e=parseInt(a.value);i.user.push(e),i.mfcc.push(y),console.log(`regenerating ${t}`),n[t].cleanUp(),n[t].generateSynth(),await n[t].compile(o),r=(r+1)%2,t=(t+1)%2,await f(),l=!1}async function f(){C.innerText=`Round ${i.user.length+1}`,s.innerText="Playing sound 1...";const e=await n[t].measureMFCC();s.innerText="Waiting...",await new Promise(w=>setTimeout(()=>w(),300)),s.innerText="Playing sound 2...";const g=await n[r].measureMFCC();s.innerText="Waiting...",y=p(e,g),a.value="1",s.innerText="Choose now!",d.innerText=a.value}async function k(){m.style.display="none",E.style.display="block",u=new window.AudioContext,o=new v.exports.Faust({wasmLocation:"src/libfaust/libfaust-wasm.wasm",dataLocation:"src/libfaust/libfaust-wasm.data"}),await o.ready;for(let e=0;e<2;e++)n.push(new b(e,u,void 0,!0,!0));await Promise.all(n.map(e=>e.compile(o))),f()}
